@extends('admin.layout')

@section('title','Schedule Maker - Settings')
@section('heading','Schedule Maker - Settings')

@section('content')

<div class="min-h-screen bg-white">
  <div class="max-w-7xl mx-auto p-6">

    <!-- Demo Notice -->
    <div class="mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg">
      <p class="text-sm text-amber-800"><strong>‚ÑπÔ∏è Demo/Mock UI:</strong> This configuration interface demonstrates how scheduling settings would work. No data is saved or enforced yet.</p>
    </div>

    <!-- Tabs Navigation -->
    <div class="border-b bg-slate-50 flex">
      <button data-tab="jh" class="settings-tab flex-1 px-6 py-4 font-semibold border-b-2 border-blue-600 text-blue-600 hover:bg-blue-50">
        üìò Junior High Configuration
      </button>
      <button data-tab="sh" class="settings-tab flex-1 px-6 py-4 font-semibold text-slate-500 hover:text-slate-700 hover:bg-slate-100">
        üìó Senior High Configuration
      </button>
      <button data-tab="constraints" class="settings-tab flex-1 px-6 py-4 font-semibold text-slate-500 hover:text-slate-700 hover:bg-slate-100">
        ‚ö†Ô∏è Constraints & Rules
      </button>
    </div>

    <!-- Tab Content: Junior High -->
    <div id="tab-jh" class="settings-tab-content p-6">
      <h3 class="text-2xl font-bold text-slate-900 mb-2">üìò Junior High Configuration</h3>
      <p class="text-sm text-slate-600 mb-6">Configure scheduling parameters for Junior High (Grades 7-10)</p>

      <!-- Faculty Restrictions Form -->
      <div class="mb-8 border rounded-lg p-6 bg-white shadow">
        <form method="POST" action="{{ route('admin.schedule-maker.settings.save') }}">
          @csrf
          <input type="hidden" name="level" value="general" />
          <input type="hidden" name="section" value="faculty_restrictions" />

          <h4 class="text-md font-semibold mb-3 text-slate-800">üë• Faculty Period Restrictions</h4>
          <p class="text-sm text-slate-600 mb-4">Prevent specific faculty roles from teaching during certain periods.</p>
          
          <div id="restrictions-container" class="space-y-4 mb-4">
            <!-- Dynamic restrictions will be added here -->
          </div>

          <button type="button" id="add-restriction" class="px-4 py-2 text-sm bg-slate-600 text-white rounded hover:bg-slate-700 mb-4">
            + Add Faculty Restriction
          </button>

          <div class="border-t pt-4 flex justify-end">
            <button type="submit" class="px-5 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-medium">
              Save Faculty Restrictions
            </button>
          </div>
        </form>
      </div>

      <!-- Subject Period Constraints Form -->
      <div class="mb-8 border rounded-lg p-6 bg-white shadow">
        <form method="POST" action="{{ route('admin.schedule-maker.settings.save') }}">
          @csrf
          <input type="hidden" name="level" value="general" />
          <input type="hidden" name="section" value="subject_constraints" />

          <h4 class="text-md font-semibold mb-3 text-slate-800">üìö Subject Period Constraints</h4>
          <p class="text-sm text-slate-600 mb-4">Restrict specific subjects from being scheduled in certain periods.</p>
          
          <div id="subject-constraints-container" class="space-y-4 mb-4">
            <!-- Dynamic constraints will be added here -->
          </div>

          <button type="button" id="add-subject-constraint" class="px-4 py-2 text-sm bg-slate-600 text-white rounded hover:bg-slate-700 mb-4">
            + Add Subject Constraint
          </button>

          <div class="border-t pt-4 flex justify-end">
            <button type="submit" class="px-5 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-medium">
              Save Subject Constraints
            </button>
          </div>
        </form>
      </div>

      <!-- Load Balancing & Optimization Form -->
      <div class="mb-8 border rounded-lg p-6 bg-white shadow">
        <form method="POST" action="{{ route('admin.schedule-maker.settings.save') }}">
          @csrf
          <input type="hidden" name="level" value="general" />
          <input type="hidden" name="section" value="optimization" />

          <h4 class="text-md font-semibold mb-3 text-slate-800">‚öñÔ∏è Load Balancing & Optimization</h4>
          <p class="text-sm text-slate-600 mb-4">Configure workload distribution and optimization rules.</p>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Max Consecutive Periods</label>
              <input type="number" name="optimization_settings[max_consecutive_periods]" 
                     value="{{ $generalConfig->optimization_settings['max_consecutive_periods'] ?? 4 }}" 
                     min="1" max="9" class="input w-full" />
              <p class="text-xs text-slate-500 mt-1">Maximum continuous teaching periods without break</p>
            </div>

            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Max Teaching Days/Week</label>
              <input type="number" name="optimization_settings[max_teaching_days_per_week]" 
                     value="{{ $generalConfig->optimization_settings['max_teaching_days_per_week'] ?? 6 }}" 
                     min="1" max="7" class="input w-full" />
              <p class="text-xs text-slate-500 mt-1">Maximum days a teacher should work</p>
            </div>

            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Load Distribution Threshold</label>
              <input type="number" name="optimization_settings[load_distribution_threshold]" 
                     value="{{ $generalConfig->optimization_settings['load_distribution_threshold'] ?? 3.5 }}" 
                     min="0.5" max="10" step="0.5" class="input w-full" />
              <p class="text-xs text-slate-500 mt-1">Acceptable workload variation between teachers</p>
            </div>
          </div>

          <div class="space-y-3 mb-6">
            <label class="flex items-center gap-3">
              <input type="checkbox" name="optimization_settings[balance_workload]" value="1" 
                     {{ ($generalConfig->optimization_settings['balance_workload'] ?? true) ? 'checked' : '' }} 
                     class="rounded" />
              <span class="text-sm text-slate-700">Automatically balance teacher workload</span>
            </label>

            <label class="flex items-center gap-3">
              <input type="checkbox" name="optimization_settings[minimize_gaps]" value="1" 
                     {{ ($generalConfig->optimization_settings['minimize_gaps'] ?? true) ? 'checked' : '' }} 
                     class="rounded" />
              <span class="text-sm text-slate-700">Minimize gaps in teacher schedules</span>
            </label>

            <label class="flex items-center gap-3">
              <input type="checkbox" name="optimization_settings[respect_preferences]" value="1" 
                     {{ ($generalConfig->optimization_settings['respect_preferences'] ?? false) ? 'checked' : '' }} 
                     class="rounded" />
              <span class="text-sm text-slate-700">Respect teacher period preferences when possible</span>
            </label>
          </div>

          <div class="border-t pt-4 flex justify-end">
            <button type="submit" class="px-5 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-medium">
              Save Optimization Settings
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Tab Content: Junior High -->
    <div id="tab-jh" class="settings-tab-content hidden p-6">
      <h3 class="text-lg font-bold text-slate-900 mb-6">üìò Junior High Configuration</h3>

      <!-- School Days & Sessions -->
      <div class="mb-8 border rounded-lg p-6 bg-white shadow">
        <form method="POST" action="{{ route('admin.schedule-maker.settings.save') }}">
          @csrf
          <input type="hidden" name="level" value="junior_high" />
          <input type="hidden" name="section" value="calendar" />

          <h4 class="text-md font-semibold mb-3 text-slate-800">üìÖ School Days</h4>
          <p class="text-sm text-slate-600 mb-4">Select active school days for Junior High.</p>
          
          <div class="flex gap-3 mb-6">
            @foreach($allDays as $d => $label)
              <label class="flex flex-col items-center gap-2 cursor-pointer">
                <input type="checkbox" name="days[{{ $d }}][is_active]" value="1" class="peer hidden" />
                <div class="w-16 h-16 rounded-full border-2 flex items-center justify-center font-medium transition-all peer-checked:bg-blue-500 peer-checked:text-white peer-checked:border-blue-600 hover:border-blue-400 bg-white border-slate-300">
                  {{ $label }}
                </div>
              </label>
            @endforeach
          </div>

          <h4 class="text-md font-semibold mb-3 text-slate-800 mt-6">‚è±Ô∏è Period Structure</h4>
          <div class="grid grid-cols-2 gap-6 mb-6">
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Regular Session Periods</label>
              <input type="number" name="regular_period_count" value="{{ $jh->regular_period_count ?? 8 }}" min="1" max="12" class="input w-full" />
              <p class="text-xs text-slate-500 mt-1">Number of periods on regular days</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Shortened Session Periods</label>
              <input type="number" name="shortened_period_count" value="{{ $jh->shortened_period_count ?? 6 }}" min="1" max="12" class="input w-full" />
              <p class="text-xs text-slate-500 mt-1">Number of periods on shortened days</p>
            </div>
          </div>

          <div class="border-t pt-4 flex justify-end">
            <button type="submit" class="px-5 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-medium">
              Save JH Calendar
            </button>
          </div>
        </form>
      </div>

      <!-- Workload Limits -->
      <div class="mb-8 border rounded-lg p-6 bg-white shadow">
        <form method="POST" action="{{ route('admin.schedule-maker.settings.save') }}">
          @csrf
          <input type="hidden" name="level" value="junior_high" />
          <input type="hidden" name="section" value="workload" />

          <h4 class="text-md font-semibold mb-3 text-slate-800">üìä Teacher Workload Limits</h4>
          <p class="text-sm text-slate-600 mb-4">Set min/max constraints for JH teachers.</p>
          
          <div class="grid grid-cols-3 gap-6">
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Max Subjects per Teacher</label>
              <input type="number" name="max_subjects" value="{{ $jh->max_subjects ?? 3 }}" min="1" max="8" class="input w-full" />
            </div>
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Max Sections per Teacher</label>
              <input type="number" name="max_sections" value="{{ $jh->max_sections ?? 6 }}" min="1" max="15" class="input w-full" />
            </div>
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Max Hours per Week</label>
              <input type="number" name="max_hours" value="{{ $jh->max_hours ?? 30 }}" min="1" max="60" class="input w-full" />
            </div>
          </div>

          <div class="border-t pt-4 flex justify-end mt-6">
            <button type="submit" class="px-5 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-medium">
              Save JH Workload
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Tab Content: Senior High -->
    <div id="tab-sh" class="settings-tab-content hidden p-6">
      <h3 class="text-lg font-bold text-slate-900 mb-6">üìó Senior High Configuration</h3>

      <!-- School Days & Sessions -->
      <div class="mb-8 border rounded-lg p-6 bg-white shadow">
        <form method="POST" action="{{ route('admin.schedule-maker.settings.save') }}">
          @csrf
          <input type="hidden" name="level" value="senior_high" />
          <input type="hidden" name="section" value="calendar" />

          <h4 class="text-md font-semibold mb-3 text-slate-800">üìÖ School Days</h4>
          <p class="text-sm text-slate-600 mb-4">Select active school days for Senior High.</p>
          
          <div class="flex gap-3 mb-6">
            @foreach($allDays as $d => $label)
              <label class="flex flex-col items-center gap-2 cursor-pointer">
                <input type="checkbox" name="days[{{ $d }}][is_active]" value="1" class="peer hidden" />
                <div class="w-16 h-16 rounded-full border-2 flex items-center justify-center font-medium transition-all peer-checked:bg-green-500 peer-checked:text-white peer-checked:border-green-600 hover:border-green-400 bg-white border-slate-300">
                  {{ $label }}
                </div>
              </label>
            @endforeach
          </div>

          <h4 class="text-md font-semibold mb-3 text-slate-800 mt-6">‚è±Ô∏è Period Structure</h4>
          <div class="grid grid-cols-2 gap-6 mb-6">
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Regular Session Periods</label>
              <input type="number" name="regular_period_count" value="{{ $sh->regular_period_count ?? 6 }}" min="1" max="12" class="input w-full" />
              <p class="text-xs text-slate-500 mt-1">Number of periods on regular days</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Shortened Session Periods</label>
              <input type="number" name="shortened_period_count" value="{{ $sh->shortened_period_count ?? 4 }}" min="1" max="12" class="input w-full" />
              <p class="text-xs text-slate-500 mt-1">Number of periods on shortened days</p>
            </div>
          </div>

          <div class="border-t pt-4 flex justify-end">
            <button type="submit" class="px-5 py-2 bg-green-600 text-white rounded hover:bg-green-700 font-medium">
              Save SH Calendar
            </button>
          </div>
        </form>
      </div>

      <!-- Workload Limits -->
      <div class="mb-8 border rounded-lg p-6 bg-white shadow">
        <form method="POST" action="{{ route('admin.schedule-maker.settings.save') }}">
          @csrf
          <input type="hidden" name="level" value="senior_high" />
          <input type="hidden" name="section" value="workload" />

          <h4 class="text-md font-semibold mb-3 text-slate-800">üìä Teacher Workload Limits</h4>
          <p class="text-sm text-slate-600 mb-4">Set min/max constraints for SH teachers.</p>
          
          <div class="grid grid-cols-3 gap-6">
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Max Subjects per Teacher</label>
              <input type="number" name="max_subjects" value="{{ $sh->max_subjects ?? 2 }}" min="1" max="8" class="input w-full" />
            </div>
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Max Sections per Teacher</label>
              <input type="number" name="max_sections" value="{{ $sh->max_sections ?? 4 }}" min="1" max="15" class="input w-full" />
            </div>
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-2">Max Hours per Week</label>
              <input type="number" name="max_hours" value="{{ $sh->max_hours ?? 24 }}" min="1" max="60" class="input w-full" />
            </div>
          </div>

          <div class="border-t pt-4 flex justify-end mt-6">
            <button type="submit" class="px-5 py-2 bg-green-600 text-white rounded hover:bg-green-700 font-medium">
              Save SH Workload
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Tab Content: Period Grid Configuration -->
    <div id="tab-periods" class="settings-tab-content hidden p-6">
      <h3 class="text-lg font-bold text-slate-900 mb-6">üïê Period Grid Configuration</h3>
      
      <div class="mb-6 p-4 bg-amber-50 border border-amber-200 rounded">
        <p class="text-sm text-amber-800"><strong>‚ÑπÔ∏è Demo/Mock UI:</strong> Period times shown here will control the Master Schedule when configured.</p>
      </div>

      <!-- Junior High Periods -->
      <div class="mb-8 border rounded-lg p-6 bg-white shadow">
        <h4 class="text-md font-semibold mb-4 text-slate-800">üìò Junior High Periods</h4>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          <!-- Regular Session -->
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-3">Regular Session</label>
            <div class="space-y-2">
              <div class="grid grid-cols-3 gap-2 text-xs font-medium text-slate-600 mb-2">
                <div>Period</div>
                <div>Start Time</div>
                <div>End Time</div>
              </div>
              <div class="grid grid-cols-3 gap-2">
                <div class="text-sm font-medium">P1</div>
                <input type="time" value="07:30" class="input text-xs" disabled />
                <input type="time" value="08:30" class="input text-xs" disabled />
              </div>
              <div class="grid grid-cols-3 gap-2">
                <div class="text-sm font-medium">P2</div>
                <input type="time" value="08:30" class="input text-xs" disabled />
                <input type="time" value="09:30" class="input text-xs" disabled />
              </div>
            </div>
            <button class="mt-4 px-4 py-2 bg-slate-300 text-slate-700 rounded text-sm font-semibold cursor-not-allowed opacity-50" disabled title="Demo only - not functional">
              üíæ Save Regular Times
            </button>
          </div>

          <!-- Shortened Session -->
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-3">Shortened Session</label>
            <div class="space-y-2">
              <div class="grid grid-cols-3 gap-2 text-xs font-medium text-slate-600 mb-2">
                <div>Period</div>
                <div>Start Time</div>
                <div>End Time</div>
              </div>
              <div class="grid grid-cols-3 gap-2">
                <div class="text-sm font-medium">P1</div>
                <input type="time" value="07:30" class="input text-xs" disabled />
                <input type="time" value="08:20" class="input text-xs" disabled />
              </div>
              <div class="grid grid-cols-3 gap-2">
                <div class="text-sm font-medium">P2</div>
                <input type="time" value="08:20" class="input text-xs" disabled />
                <input type="time" value="09:10" class="input text-xs" disabled />
              </div>
            </div>
            <button class="mt-4 px-4 py-2 bg-slate-300 text-slate-700 rounded text-sm font-semibold cursor-not-allowed opacity-50" disabled title="Demo only - not functional">
              üíæ Save Shortened Times
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab Content: Subject Availability Matrix -->
    <div id="tab-subject-matrix" class="settings-tab-content hidden p-6">
      <h3 class="text-lg font-bold text-slate-900 mb-6">üìä Subject Availability Matrix</h3>
      
      <div class="mb-6 p-4 bg-amber-50 border border-amber-200 rounded">
        <p class="text-sm text-amber-800"><strong>‚ÑπÔ∏è Demo/Mock UI:</strong> Mark which periods each subject can be taught. Unchecked = subject restricted from that period.</p>
      </div>

      <div class="overflow-x-auto border rounded-lg">
        <table class="w-full text-sm">
          <thead class="bg-slate-100 border-b">
            <tr>
              <th class="px-4 py-2 text-left font-semibold text-slate-700">Subject</th>
              <th class="px-4 py-2 text-center font-semibold text-slate-700 bg-blue-50">P1</th>
              <th class="px-4 py-2 text-center font-semibold text-slate-700">P2</th>
              <th class="px-4 py-2 text-center font-semibold text-slate-700 bg-blue-50">P3</th>
              <th class="px-4 py-2 text-center font-semibold text-slate-700">P4</th>
              <th class="px-4 py-2 text-center font-semibold text-slate-700 bg-blue-50">P5</th>
              <th class="px-4 py-2 text-center font-semibold text-slate-700">P6</th>
              <th class="px-4 py-2 text-center font-semibold text-slate-700 bg-blue-50">P7</th>
              <th class="px-4 py-2 text-center font-semibold text-slate-700">P8</th>
              <th class="px-4 py-2 text-center font-semibold text-slate-700 bg-blue-50">P9</th>
            </tr>
          </thead>
          <tbody class="divide-y">
            <tr class="hover:bg-slate-50">
              <td class="px-4 py-3 font-medium text-slate-900">Math</td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" disabled class="w-4 h-4" /></td>
            </tr>
            <tr class="hover:bg-slate-50">
              <td class="px-4 py-3 font-medium text-slate-900">PE</td>
              <td class="px-4 py-3 text-center"><input type="checkbox" disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" checked disabled class="w-4 h-4" /></td>
              <td class="px-4 py-3 text-center"><input type="checkbox" disabled class="w-4 h-4" /></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="mt-4 flex justify-end">
        <button class="px-4 py-2 bg-slate-300 text-slate-700 rounded text-sm font-semibold cursor-not-allowed opacity-50" disabled title="Demo only - not functional">
          üíæ Save Subject Availability
        </button>
      </div>
    </div>

    <!-- Tab Content: Load Balancing Strategy -->
    <div id="tab-load-balance" class="settings-tab-content hidden p-6">
      <h3 class="text-lg font-bold text-slate-900 mb-6">‚öñÔ∏è Load Balancing Strategy</h3>
      
      <div class="mb-6 p-4 bg-amber-50 border border-amber-200 rounded">
        <p class="text-sm text-amber-800"><strong>‚ÑπÔ∏è Demo/Mock UI:</strong> These settings will guide how the algorithm distributes teaching load across teachers.</p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Distribution Strategy -->
        <div class="border rounded-lg p-6 bg-white shadow">
          <h4 class="text-md font-semibold mb-4 text-slate-800">Distribution Strategy</h4>
          <div class="space-y-3">
            <label class="flex items-center gap-3 cursor-pointer">
              <input type="radio" name="distribution_strategy" value="balanced" checked disabled class="w-4 h-4" />
              <div>
                <div class="font-medium text-slate-700">Balanced Load</div>
                <div class="text-xs text-slate-500">Evenly distribute teaching periods across all teachers</div>
              </div>
            </label>
            <label class="flex items-center gap-3 cursor-pointer">
              <input type="radio" name="distribution_strategy" value="consecutive" disabled class="w-4 h-4" />
              <div>
                <div class="font-medium text-slate-700">Compress to Fewer Days</div>
                <div class="text-xs text-slate-500">Group teaching periods together to maximize free days</div>
              </div>
            </label>
          </div>
        </div>

        <!-- Free Period Preference -->
        <div class="border rounded-lg p-6 bg-white shadow">
          <h4 class="text-md font-semibold mb-4 text-slate-800">Free Period Preference</h4>
          <div class="space-y-3">
            <label class="flex items-center gap-3 cursor-pointer">
              <input type="radio" name="free_period_pref" value="scattered" checked disabled class="w-4 h-4" />
              <div>
                <div class="font-medium text-slate-700">Scattered Throughout</div>
                <div class="text-xs text-slate-500">Distribute free periods evenly across day</div>
              </div>
            </label>
          </div>
        </div>
      </div>

      <div class="mt-6 flex justify-end">
        <button class="px-4 py-2 bg-slate-300 text-slate-700 rounded text-sm font-semibold cursor-not-allowed opacity-50" disabled title="Demo only - not functional">
          üíæ Save Load Balancing Strategy
        </button>
      </div>
    </div>

    <!-- Tab Content: Conflict Rules -->
    <div id="tab-conflict-rules" class="settings-tab-content hidden p-6">
      <h3 class="text-lg font-bold text-slate-900 mb-6">‚ö†Ô∏è Conflict Detection & Rules</h3>
      
      <div class="mb-6 p-4 bg-amber-50 border border-amber-200 rounded">
        <p class="text-sm text-amber-800"><strong>‚ÑπÔ∏è Demo/Mock UI:</strong> These rules define what the algorithm detects as conflicts and their priority.</p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Critical Constraints -->
        <div class="border rounded-lg p-6 bg-white shadow">
          <h4 class="text-md font-semibold mb-4 text-slate-800 flex items-center gap-2">
            <span class="bg-red-100 text-red-700 text-xs px-2 py-1 rounded font-bold">CRITICAL</span>
            Hard Constraints
          </h4>
          <div class="space-y-3 text-sm">
            <label class="flex items-start gap-3 cursor-pointer">
              <input type="checkbox" checked disabled class="w-4 h-4 mt-0.5" />
              <div>
                <div class="font-medium text-slate-700">No teacher overlap</div>
                <div class="text-xs text-slate-500">Same teacher cannot teach 2+ sections at same time</div>
              </div>
            </label>
            <label class="flex items-start gap-3 cursor-pointer">
              <input type="checkbox" checked disabled class="w-4 h-4 mt-0.5" />
              <div>
                <div class="font-medium text-slate-700">Respect teacher qualifications</div>
                <div class="text-xs text-slate-500">Only assign if teacher has subject expertise</div>
              </div>
            </label>
          </div>
        </div>

        <!-- High Priority Rules -->
        <div class="border rounded-lg p-6 bg-white shadow">
          <h4 class="text-md font-semibold mb-4 text-slate-800 flex items-center gap-2">
            <span class="bg-orange-100 text-orange-700 text-xs px-2 py-1 rounded font-bold">HIGH</span>
            Preferred Rules
          </h4>
          <div class="space-y-3 text-sm">
            <label class="flex items-start gap-3 cursor-pointer">
              <input type="checkbox" checked disabled class="w-4 h-4 mt-0.5" />
              <div>
                <div class="font-medium text-slate-700">Respect period restrictions</div>
                <div class="text-xs text-slate-500">Honor subject availability matrix settings</div>
              </div>
            </label>
            <label class="flex items-start gap-3 cursor-pointer">
              <input type="checkbox" checked disabled class="w-4 h-4 mt-0.5" />
              <div>
                <div class="font-medium text-slate-700">Workload limits</div>
                <div class="text-xs text-slate-500">No teacher exceeds max hours per week</div>
              </div>
            </label>
          </div>
        </div>

        <!-- Info Panel -->
        <div class="border rounded-lg p-6 bg-blue-50 border-blue-200">
          <h4 class="text-md font-semibold mb-4 text-slate-800">Detection Levels</h4>
          <div class="space-y-2 text-sm text-slate-700">
            <p><strong>Red = Critical:</strong> Must resolve before publishing</p>
            <p><strong>Orange = High:</strong> Should resolve if possible</p>
            <p><strong>Yellow = Medium:</strong> Nice to fix for optimization</p>
          </div>
        </div>
      </div>

      <div class="mt-6 flex justify-end">
        <button class="px-4 py-2 bg-slate-300 text-slate-700 rounded text-sm font-semibold cursor-not-allowed opacity-50" disabled title="Demo only - not functional">
          üíæ Save Conflict Rules
        </button>
      </div>
    </div>

  </div>
</div>

<script>
  // Tab switching functionality
  document.addEventListener('DOMContentLoaded', function() {
    const tabs = document.querySelectorAll('.settings-tab');
    const tabContents = document.querySelectorAll('.settings-tab-content');

    tabs.forEach(tab => {
      tab.addEventListener('click', function() {
        const targetTab = this.getAttribute('data-tab');

        // Update tab styling
        tabs.forEach(t => {
          t.classList.remove('border-blue-600', 'text-blue-600');
          t.classList.add('text-slate-500');
        });
        this.classList.add('border-blue-600', 'text-blue-600');
        this.classList.remove('text-slate-500');

        // Show/hide content
        tabContents.forEach(content => {
          content.classList.add('hidden');
        });
        document.getElementById(`tab-${targetTab}`).classList.remove('hidden');
      });
    });

    // Period times for visual selectors
    const periodTimes = ['7:30', '8:30', '9:30', '10:30', '11:30', '1:00', '2:00', '3:00', '4:00'];
    
    // Faculty restriction row functionality
    let restrictionIndex = 0;
    
    function createRestrictionRow() {
      const row = document.createElement('div');
      row.className = 'restriction-row border rounded-lg p-4 bg-slate-50';
      row.innerHTML = `
        <div class="mb-4">
          <label class="block text-sm font-medium text-slate-700 mb-2">Faculty Role/Assignment</label>
          <input type="text" 
                 name="restrictions[${restrictionIndex}][type]" 
                 placeholder="e.g., Guidance Counselor, Librarian..." 
                 class="input w-full" 
                 required />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-700 mb-3">
            Restricted Periods
            <span class="text-xs font-normal text-slate-500 ml-2">(Click periods to mark as restricted)</span>
          </label>
          <div class="grid grid-cols-9 gap-2">
            ${Array.from({length: 9}, (_, i) => i + 1).map(p => `
              <label class="period-selector cursor-pointer">
                <input type="checkbox" name="restrictions[${restrictionIndex}][periods][]" value="${p}" class="peer hidden" />
                <div class="h-16 border-2 rounded-lg flex flex-col items-center justify-center transition-all peer-checked:bg-red-100 peer-checked:border-red-500 peer-checked:text-red-800 hover:border-blue-400 bg-white border-slate-300">
                  <div class="font-bold text-lg">P${p}</div>
                  <div class="text-xs text-slate-500 peer-checked:text-red-600">${periodTimes[p-1]}</div>
                </div>
              </label>
            `).join('')}
          </div>
          <div class="mt-2 text-xs text-slate-500">
            <span class="inline-block w-3 h-3 bg-white border-2 border-slate-300 rounded mr-1"></span> Available
            <span class="inline-block w-3 h-3 bg-red-100 border-2 border-red-500 rounded ml-3 mr-1"></span> Restricted
          </div>
        </div>

        <button type="button" class="remove-restriction mt-4 text-red-600 hover:text-red-800 text-sm font-medium" onclick="this.closest('.restriction-row').remove()">
          ‚úï Remove Restriction
        </button>
      `;
      restrictionIndex++;
      return row;
    }

    document.getElementById('add-restriction').addEventListener('click', function() {
      document.getElementById('restrictions-container').appendChild(createRestrictionRow());
    });

    // Subject constraint row functionality
    let constraintIndex = 0;
    const subjectOptions = @json($subjects);
    
    function createConstraintRow() {
      const row = document.createElement('div');
      row.className = 'constraint-row border rounded-lg p-4 bg-slate-50';
      row.innerHTML = `
        <div class="mb-4">
          <label class="block text-sm font-medium text-slate-700 mb-2">Subject</label>
          <select name="subject_constraints[${constraintIndex}][subject_id]" class="input w-full" required>
            <option value="">-- Select Subject --</option>
            ${subjectOptions.map(s => `<option value="${s.id}">${s.name}</option>`).join('')}
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-700 mb-3">
            Restricted Periods
            <span class="text-xs font-normal text-slate-500 ml-2">(Click periods to mark as restricted)</span>
          </label>
          <div class="grid grid-cols-9 gap-2">
            ${Array.from({length: 9}, (_, i) => i + 1).map(p => `
              <label class="period-selector cursor-pointer">
                <input type="checkbox" name="subject_constraints[${constraintIndex}][periods][]" value="${p}" class="peer hidden" />
                <div class="h-16 border-2 rounded-lg flex flex-col items-center justify-center transition-all peer-checked:bg-red-100 peer-checked:border-red-500 peer-checked:text-red-800 hover:border-blue-400 bg-white border-slate-300">
                  <div class="font-bold text-lg">P${p}</div>
                  <div class="text-xs text-slate-500 peer-checked:text-red-600">${periodTimes[p-1]}</div>
                </div>
              </label>
            `).join('')}
          </div>
          <div class="mt-2 text-xs text-slate-500">
            <span class="inline-block w-3 h-3 bg-white border-2 border-slate-300 rounded mr-1"></span> Available
            <span class="inline-block w-3 h-3 bg-red-100 border-2 border-red-500 rounded ml-3 mr-1"></span> Restricted
          </div>
        </div>

        <button type="button" class="remove-constraint mt-4 text-red-600 hover:text-red-800 text-sm font-medium" onclick="this.closest('.constraint-row').remove()">
          ‚úï Remove Constraint
        </button>
      `;
      constraintIndex++;
      return row;
    }

    document.getElementById('add-subject-constraint').addEventListener('click', function() {
      document.getElementById('subject-constraints-container').appendChild(createConstraintRow());
    });
  });
</script>
@endsection
